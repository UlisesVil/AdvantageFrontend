(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{V1YL:function(t,e,i){"use strict";i.r(e),i.d(e,"UserModule",(function(){return k}));var r=i("ofXK"),a=i("3Pt+"),n=i("tk/3"),o=i("tyNb");class s{constructor(t,e,i,r,a,n){this.userId=t,this.userName=e,this.lastName=i,this.secondSurName=r,this.email=a,this.birthDate=n}}var c=i("fXoL"),d=i("voiJ");let u=(()=>{class t{constructor(t){this._http=t,this.url=d.a.url}saveUserData(t){t=JSON.stringify(t);let e=(new n.d).set("Content-Type","application/json");return this._http.post(this.url+"save-userdata",t,{headers:e})}uploadimg(t){return this._http.post(this.url+"uploadimg",t)}uploadimgBase64(t){return this._http.post(this.url+"uploadimgBase64",t)}getUser(t){let e=(new n.d).set("Content-Type","application/json");return this._http.get(this.url+"getuser/"+t,{headers:e})}updateImageUrl(t){return this._http.post(this.url+"updateImageUrl",t)}}return t.\u0275fac=function(e){return new(e||t)(c.Tb(n.b))},t.\u0275prov=c.Gb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var l=i("FKr1"),b=i("jhN1"),p=i("kmnG"),h=i("qFsG"),m=i("iadO"),g=i("bTqV");const f=["canvasRef"];function x(t,e){if(1&t&&c.Lb(0,"img",27),2&t){const t=c.Zb();c.dc("src",t.imageToDownload,c.jc)}}function w(t,e){if(1&t){const t=c.Qb();c.Pb(0,"a",28),c.Wb("click",(function(){return c.ic(t),c.Zb().onSubmitImage()})),c.Pb(1,"button",29),c.rc(2,"Descargar y guardar"),c.Ob(),c.Ob()}if(2&t){const t=c.Zb();c.dc("href",t.imageToDownload,c.jc)}}function v(t,e){if(1&t&&c.Lb(0,"img",30),2&t){const t=c.Zb();c.cc("src",t.signature,c.jc)}}const O=[{path:"user-main",component:(()=>{class t{constructor(t,e,i,r,a){this._userMainService=t,this._formBuilder=e,this._router=i,this.dateAdapter=r,this._sanitizer=a,this.points=[],this.width=400,this.height=150,this.img=!1,this.files=[],this.uploadedFiles=[],this.signature="no-image",this.signatureMessage="Aun No cuentas con Firma Digital",this.onMouseMove=t=>{"canvasId"===t.target.id&&this.isAvailable&&this.write(t)},this.onClick=t=>{"canvasId"===t.target.id&&(this.isAvailable=!this.isAvailable)},this.writeSingle=t=>{this.points.push(t),this.points.length>3&&this.drawOnCanvas(this.points[this.points.length-1],this.points[this.points.length-2])},this.extraerBase64=t=>{return e=this,void 0,r=function*(){return new Promise((e,i)=>{try{const i=window.URL.createObjectURL(t),r=(this._sanitizer.bypassSecurityTrustUrl(i),new FileReader);r.readAsDataURL(t),r.onload=()=>{e({base:r.result}),r.onerror=t=>{e({base:null})}}}catch(r){return null}})},new((i=void 0)||(i=Promise))((function(t,a){function n(t){try{s(r.next(t))}catch(e){a(e)}}function o(t){try{s(r.throw(t))}catch(e){a(e)}}function s(e){var r;e.done?t(e.value):(r=e.value,r instanceof i?r:new i((function(t){t(r)}))).then(n,o)}s((r=r.apply(e,[])).next())}));var e,i,r},this.dateAdapter.setLocale("en-GB"),this.userData=new s("","","","","",new Date),this.formCreate()}ngOnInit(){this.menusInSession(),this.getUser()}ngOnChanges(){this.menusInSession()}menusInSession(){this.token=localStorage.getItem("token"),this.getUserData=localStorage.getItem("payload"),null!=this.getUserData&&(this.user=JSON.parse(this.getUserData))}ngAfterViewInit(){this.render()}formCreate(){this.form=this._formBuilder.group({userId:["",[a.p.required]],name:["",[a.p.required]],lastName:["",[a.p.required]],secondSurName:["",[a.p.required]],email:["",[a.p.required]],birthDate:["",[a.p.required]]})}getUser(){this._userMainService.getUser(this.user.id).subscribe(t=>{t.data&&(this.form=this._formBuilder.group({userId:[t.data._id,[a.p.required]],name:[t.data.userName,[a.p.required]],lastName:[t.data.lastName,[a.p.required]],secondSurName:[t.data.secondSurName,[a.p.required]],email:[t.data.email,[a.p.required]],birthDate:[t.data.birthDate,[a.p.required]]}),this.signature=t.data.signature,"no-image"!==this.signature&&(this.signatureMessage="Esta es tu Firma Guardada"),this.userDataId=t.data._id)},t=>{this.form=this._formBuilder.group({userId:[this.user.id,[a.p.required]],name:[this.user.userName,[a.p.required]],lastName:[this.user.lastName,[a.p.required]],secondSurName:[this.user.secondSurName,[a.p.required]],email:[this.user.email,[a.p.required]],birthDate:[this.user.birthDate,[a.p.required]]}),this.signature="no-image"})}onSubmitData(){this.form.valid&&(this.userData={userId:this.form.value.userId,userName:this.form.value.name,lastName:this.form.value.lastName,secondSurName:this.form.value.secondSurName,email:this.form.value.email,birthDate:this.form.value.birthDate},this._userMainService.saveUserData(this.userData).subscribe(t=>{window.location.reload()},t=>{console.log(t)}))}render(){const t=this.canvasRef.nativeElement;this.cx=t.getContext("2d"),t.width=this.width,t.height=this.height,this.cx.lineWidth=3,this.cx.lineCap="round",this.cx.strokeStyle="#000"}write(t){const e=this.canvasRef.nativeElement.getBoundingClientRect();this.writeSingle({x:t.clientX-e.left,y:t.clientY-e.top})}drawOnCanvas(t,e){this.cx&&(this.cx.beginPath(),t&&(this.cx.moveTo(t.x,t.y),this.cx.lineTo(e.x,e.y),this.cx.stroke()))}clean(){this.points=[],this.cx.clearRect(0,0,this.width,this.height)}imageDownload(){this.imageToDownload=this.canvasRef.nativeElement.toDataURL(),this.img=!0}fileCath(t){const e=t.target.files[0];this.extraerBase64(e).then(t=>{this.previsualization=t.base}),this.files.push(e),this.uploadedFiles=t.target.files}onSubmitImage(){let t=new FormData;for(let e=0;e<this.uploadedFiles.length;e++)t.append("uploads[]",this.uploadedFiles[e],this.uploadedFiles[e].name);this._userMainService.uploadimgBase64({base64image:this.imageToDownload}).subscribe(t=>{this._userMainService.updateImageUrl({userId:this.userDataId,url:t.imageUrl}).subscribe(t=>{window.location.reload()})})}}return t.\u0275fac=function(e){return new(e||t)(c.Kb(u),c.Kb(a.d),c.Kb(o.a),c.Kb(l.a),c.Kb(b.b))},t.\u0275cmp=c.Eb({type:t,selectors:[["app-user-main"]],viewQuery:function(t,e){var i;1&t&&c.uc(f,!0),2&t&&c.fc(i=c.Xb())&&(e.canvasRef=i.first)},hostBindings:function(t,e){1&t&&c.Wb("mousemove",(function(t){return e.onMouseMove(t)}),!1,c.hc)("click",(function(t){return e.onClick(t)}))},features:[c.yb],decls:70,vars:9,consts:[[1,"wrap"],[1,"box"],[1,"container"],["id","userDataForm",3,"formGroup"],[1,"header"],[1,"group"],["matInput","","type","text","name","userId","placeholder","userId","formControlName","userId","required","","readonly",""],[1,"form_error"],["matInput","","type","text","name","name","placeholder","Nombre","formControlName","name","required","","readonly",""],["matInput","","type","text","name","lastName","placeholder","Apellido Paterno","formControlName","lastName","required","","readonly",""],["matInput","","type","text","name","secondSurName","placeholder","Apellido Materno","formControlName","secondSurName","required","","readonly",""],["matInput","","type","email","name","email","placeholder","E-mail","formControlName","email","required","","readonly","",3,"email"],["appearance","outline",1,"datesField"],["readonly","","matInput","","formControlName","birthDate",3,"matDatepicker"],["picker",""],["matSuffix","",3,"for"],["mat-raised-button","","color","accent","type","submit",1,"submit",3,"disabled","click"],[1,"signature-pad"],[1,"signature-pad--body"],[1,"indicator"],["id","canvasId"],["canvasRef",""],["mat-raised-button","","color","accent",3,"click"],["alt","",3,"src",4,"ngIf"],["download","",3,"href","click",4,"ngIf"],[1,"imageSaved",2,"background","white !important"],["alt","","width","250px",3,"src",4,"ngIf"],["alt","",3,"src"],["download","",3,"href","click"],["mat-raised-button","","color","accent"],["alt","","width","250px",3,"src"]],template:function(t,e){if(1&t&&(c.Pb(0,"div",0),c.Pb(1,"section"),c.Pb(2,"div",1),c.Pb(3,"div",2),c.Pb(4,"form",3),c.Pb(5,"div",4),c.Pb(6,"h1"),c.rc(7,"Datos de Usuario"),c.Ob(),c.Lb(8,"hr"),c.Pb(9,"p"),c.rc(10,"Introduce tu Fecha de Nacimiento y Telefono para guardarlos"),c.Ob(),c.Ob(),c.Pb(11,"mat-form-field",5),c.Lb(12,"input",6),c.Pb(13,"mat-error"),c.Pb(14,"span",7),c.Pb(15,"strong"),c.rc(16,"*userId requerido"),c.Ob(),c.Ob(),c.Ob(),c.Ob(),c.Pb(17,"mat-form-field",5),c.Lb(18,"input",8),c.Pb(19,"mat-error"),c.Pb(20,"span",7),c.Pb(21,"strong"),c.rc(22,"*Tu nombre es requerido"),c.Ob(),c.Ob(),c.Ob(),c.Ob(),c.Pb(23,"mat-form-field",5),c.Lb(24,"input",9),c.Pb(25,"mat-error"),c.Pb(26,"span",7),c.Pb(27,"strong"),c.rc(28,"*Tu apellido paterno es requerido"),c.Ob(),c.Ob(),c.Ob(),c.Ob(),c.Pb(29,"mat-form-field",5),c.Lb(30,"input",10),c.Pb(31,"mat-error"),c.Pb(32,"span",7),c.Pb(33,"strong"),c.rc(34,"*Tu apellido materno es requerido"),c.Ob(),c.Ob(),c.Ob(),c.Ob(),c.Pb(35,"mat-form-field",5),c.Lb(36,"input",11),c.Pb(37,"mat-error"),c.Pb(38,"span",7),c.Pb(39,"strong"),c.rc(40,"*Por favor introduce un E-mail valido"),c.Ob(),c.Ob(),c.Ob(),c.Ob(),c.Pb(41,"mat-form-field",12),c.Pb(42,"mat-label"),c.rc(43,"Fecha de Nacimiento*"),c.Ob(),c.Lb(44,"input",13),c.Lb(45,"mat-datepicker",null,14),c.Lb(47,"mat-datepicker-toggle",15),c.Pb(48,"mat-error"),c.Pb(49,"span",7),c.Pb(50,"strong"),c.rc(51,"*Por favor introduce tu Fecha de Nacimiento"),c.Ob(),c.Ob(),c.Ob(),c.Ob(),c.Pb(52,"button",16),c.Wb("click",(function(){return e.onSubmitData()})),c.rc(53,"Enviar"),c.Ob(),c.Ob(),c.Ob(),c.Ob(),c.Pb(54,"div",17),c.Pb(55,"div",18),c.Pb(56,"p",19),c.rc(57,"Firma Digital"),c.Ob(),c.Lb(58,"canvas",20,21),c.Ob(),c.Pb(60,"button",22),c.Wb("click",(function(){return e.clean()})),c.rc(61,"Limpiar"),c.Ob(),c.Pb(62,"button",22),c.Wb("click",(function(){return e.imageDownload()})),c.rc(63,"Confirmar"),c.Ob(),c.qc(64,x,1,1,"img",23),c.qc(65,w,3,1,"a",24),c.Pb(66,"div",25),c.qc(67,v,1,1,"img",26),c.Ob(),c.Pb(68,"p",19),c.rc(69),c.Ob(),c.Ob(),c.Ob(),c.Ob()),2&t){const t=c.gc(46);c.Ab(4),c.cc("formGroup",e.form),c.Ab(32),c.cc("email",!0),c.Ab(8),c.cc("matDatepicker",t),c.Ab(3),c.cc("for",t),c.Ab(5),c.cc("disabled",e.form.invalid||e.form.disabled),c.Ab(12),c.cc("ngIf",e.imageToDownload),c.Ab(1),c.cc("ngIf",e.imageToDownload),c.Ab(2),c.cc("ngIf","no-image"!=e.signature),c.Ab(2),c.tc(" ",e.signatureMessage," ")}},directives:[a.q,a.l,a.f,p.c,h.b,a.b,a.k,a.e,a.o,p.b,a.c,p.f,m.b,m.a,m.d,p.g,g.a,r.j],styles:['.wrap[_ngcontent-%COMP%]{height:-moz-fit-content;height:fit-content;background-image:url(login10.6176e700f357a4fd0984.jpg);background-repeat:no-repeat;background-size:cover;background-position:top;background-attachment:fixed}.wrap[_ngcontent-%COMP%], section[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;align-items:center}section[_ngcontent-%COMP%]{min-height:100vh;background-size:400% 400%;animation:gradient 10s ease infinite;flex-wrap:wrap;gap:30px 30px}.box[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]{position:relative}.container[_ngcontent-%COMP%]{padding:50px;width:350px;min-height:380px;display:flex;justify-content:center;align-items:center;background:rgba(35,32,32,.335);-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);border-radius:10px;box-shadow:0 25px 45px rgba(0,0,0,.2)}.container[_ngcontent-%COMP%]:after{content:"";position:absolute;top:5px;right:5px;bottom:5px;left:5px;border-radius:5px;pointer-events:none;background:linear-gradient(180deg,hsla(0,0%,100%,.1) 0,hsla(0,0%,100%,.1) 2%)}form[_ngcontent-%COMP%]{position:relative;min-width:200px;width:400px;max-width:500px;display:flex;flex-direction:column;align-items:center;justify-content:center;font-weight:700}.header[_ngcontent-%COMP%]{width:90%;text-align:center}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#fff;letter-spacing:2px;margin-bottom:30px}.header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:15px;font-size:15px}.group[_ngcontent-%COMP%]{width:90%}input[_ngcontent-%COMP%]{color:#f5f5f5;font-weight:700;letter-spacing:1px}input[_ngcontent-%COMP%]:-webkit-autofill{border:none;border-bottom:1px solid hsla(0,0%,96.1%,0);-webkit-text-fill-color:#f5f5f5;box-shadow:inset 0 0 0 1000px transparent;-webkit-transition:background-color 5000s ease-in-out 0s;transition:background-color 5000s ease-in-out 0s}.datesField[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:30px}.signature-pad[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:center;font-size:10px;width:-moz-fit-content;width:fit-content;height:100%;max-width:500px;border:1px solid #c5c5c5;box-shadow:0 1px 4px rgba(0,0,0,.27),inset 0 0 40px rgba(0,0,0,.08);border-radius:4px;padding:10px;background:hsla(0,0%,91.8%,.561)}.signature-pad--body[_ngcontent-%COMP%]{margin:auto auto 5px;position:relative;flex:1;border:1px solid #ebebeb;padding:10px;border-radius:5px}.indicator[_ngcontent-%COMP%], .signature-pad--body[_ngcontent-%COMP%]{color:#fff;font-weight:700;letter-spacing:2px}.indicator[_ngcontent-%COMP%]{font-size:13px}.imageSaved[_ngcontent-%COMP%]{display:block;border-radius:5px;border:1px solid #646464;margin-top:10px;width:-moz-fit-content;width:fit-content;background:#fff}#canvasId[_ngcontent-%COMP%]{background-color:#fff;border-radius:5px;border:1px solid rgba(0,0,0,.404)}button[_ngcontent-%COMP%]{margin:5px 0}']}),t})()}];let P=(()=>{class t{}return t.\u0275mod=c.Ib({type:t}),t.\u0275inj=c.Hb({factory:function(e){return new(e||t)},imports:[[o.d.forChild(O)],o.d]}),t})();var y=i("5dmV");let k=(()=>{class t{}return t.\u0275mod=c.Ib({type:t}),t.\u0275inj=c.Hb({factory:function(e){return new(e||t)},imports:[[r.b,P,n.c,y.a,a.g,a.n]]}),t})()}}]);